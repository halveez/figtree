---
title: "figtree"
author: "Zachary Halvorson"
date: "7/20/2019"
output: html_document
---

```{r setup}

library(tidyverse)
library(tidyr)
library(lubridate)

```

```{r fig_data}

figs_2017 <- read.csv(file = "data/2017figs.csv", header = TRUE, sep = ",", fileEncoding="UTF-8-BOM")
figs_2018 <- read.csv(file = "data/2018figs.csv", header = TRUE, sep = ",", fileEncoding="UTF-8-BOM")
figs_2019 <- read.csv(file = "data/2019figs.csv", header = TRUE, sep = ",", fileEncoding="UTF-8-BOM")

figs_2017$Day <- mdy(figs_2017$Day)
figs_2018$Day <- mdy(figs_2018$Day)
figs_2019$Day <- mdy_hm(figs_2019$Day) %>% with_tz("US/Pacific")

figs_2017 <- figs_2017 %>% complete(Day = seq.Date(min(Day), max(Day), by="day"))
figs_2018 <- figs_2018 %>% complete(Day = seq.Date(min(Day), max(Day), by="day"))
#figs_2019 <- figs_2019 %>% complete(Day = seq.Date(min(Day), max(Day), by="day"))


figs_all <- read.csv(file = "data/allfigs.csv", header = TRUE, sep = ",", fileEncoding="UTF-8-BOM")

figs_all$Day <- mdy(figs_all$Day)

figs_all <- figs_all %>% complete(Day = seq.Date(min(Day), max(Day), by="day"))


```

```{r weather_data}


weather_data <- read.csv(file = "data/weather.csv", header = TRUE, sep = ",", fileEncoding = "UTF-8-BOM")

#Next we split the weather data into the daily summary and hourly values based on the station number
daily_weather <- weather_data %>% filter(SOURCE == 6)
hourly_weather <- weather_data %>% filter(SOURCE == 7)

#split the date string at the T value for a delimiter and keep whats before for the daily dataset

#replace the t with a space for the hourly dataset

#Then convert to date types
```


```{r solar_data}

#For the solar data, we delete every other row as it is empty in the csv file

solar_data <- read.csv(file = "data/solarday.csv", header = TRUE, sep = ",", fileEncoding = "UTF-8-BOM")
delete <- seq(1, length(solar_data$Day), 2)
solar_data <- solar_data[-delete, ]

solar_data$Day <- mdy(solar_data$Day)


```



```{r quick_plot}

figs_all %>% ggplot() + geom_point(aes(x = Day, y = Combined))

solar_data %>% ggplot() + geom_point(aes(x = Day, y = Energy_Produced_Wh))


```



```{r overall_prep}

#First we must ensure that the "Day" are all m/d/y without any hour or minute day
#daily_weather_mdy <- daily_weather %>%


#Then we combine all of the separate datasets by the Day column
#overall <- merge(solar_data_mdy, figs_all, by.x = "Day", by.y = "Day")
#overall <- merge(overall, daily_weather_mdy, by.x = "Day", by.y = "Day")

```



```{r overall_plots}




```



